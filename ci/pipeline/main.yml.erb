jobs:
  - name: unit-test
    plan:
    - aggregate:
      - get: source-ci
      - get: bosh-cpi-src
        trigger: true
    - aggregate:
      - task: unit-test
        file: source-ci/ci/tasks/cpi-networking-unit-test.yml
resources:
#  - name: pool-6.5-NSXV
#    type: pool
#    source:
#      uri:          git@github.com:ktchen14/vcpi-pool.git
#      branch:       master
#      pool:         v6.5-nsxv
#      private_key:  {{vcpi-pool_deployment_key}}
#  - name: pool-6.0-NSXV
#    type: pool
#    source:
#      uri:          git@github.com:ktchen14/vcpi-pool.git
#      branch:       master
#      pool:         v6.0-nsxv
#      private_key:  {{vcpi-pool_deployment_key}}
#  - name: pool-6.5
#    type: pool
#    source:
#      uri:          git@github.com:ktchen14/vcpi-pool.git
#      branch:       master
#      pool:         v6.5
#      private_key:  {{vcpi-pool_deployment_key}}
#  - name: pool-5.5
#    type: pool
#    source:
#      uri:          git@github.com:ktchen14/vcpi-pool.git
#      branch:       master
#      pool:         v5.5
#      private_key:  {{vcpi-pool_deployment_key}}
#  - name: pool-6.0
#    type: pool
#    source:
#      uri:          git@github.com:ktchen14/vcpi-pool.git
#      branch:       master
#      pool:         v6.0
#      private_key:  {{vcpi-pool_deployment_key}}
#  - name: pool-6.7
#    type: pool
#    source:
#      uri:          git@github.com:ktchen14/vcpi-pool.git
#      branch:       master
#      pool:         v6.7
#      private_key:  {{vcpi-pool_deployment_key}}
#  - name: bosh-cpi-artifacts
#    type: s3
#    source:
#      regexp:            bosh-vsphere-cpi-([\d\.]+)\.tgz
#      bucket:            {{s3_vsphere_cpi_bucket}}
#      access_key_id:     {{s3_vsphere_cpi_blobwriter_access_key}}
#      secret_access_key: {{s3_vsphere_cpi_blobwriter_secret_key}}
  - name: source-ci
    type: git
    source:
      uri:         git@github.com:cloudfoundry-incubator/bosh-vsphere-cpi-release.git
      branch:      {{vcpi_branch}}
      private_key: {{github_deployment_key__bosh-vsphere-cpi-release}}
      paths:       [ci]
  - name: bosh-cpi-src
    type: git
    source:
      uri:         git@github.com:cloudfoundry-incubator/bosh-vsphere-cpi-release.git
      branch:      {{vcpi_branch}}
      private_key: {{github_deployment_key__bosh-vsphere-cpi-release}}
      ignore_paths: [ci]
#  - name: version-semver
#    type: semver
#    source:
#      key:               current-version
#      bucket:            {{s3_vsphere_cpi_bucket}}
#      access_key_id:     {{s3_vsphere_cpi_blobwriter_access_key}}
#      secret_access_key: {{s3_vsphere_cpi_blobwriter_secret_key}}
#  - name: release-version-semver
#    type: semver
#    source:
#      key:               release-current-version
#      bucket:            {{s3_vsphere_cpi_bucket}}
#      access_key_id:     {{s3_vsphere_cpi_blobwriter_access_key}}
#      secret_access_key: {{s3_vsphere_cpi_blobwriter_secret_key}}
#  - name: stemcell
#    type: bosh-io-stemcell
#    source:
#      name: bosh-vsphere-esxi-ubuntu-trusty-go_agent
#  - name: bosh-deployment
#    type: git
#    source:
#      uri: https://github.com/cloudfoundry/bosh-deployment
#      branch: master
#  - name: certification
#    type: git
#    source:
#      uri: https://github.com/cloudfoundry-incubator/bosh-cpi-certification
#      branch: master
#  - name: old-bosh-release
#    type: s3
#    source:
#      bucket: bosh-cpi-certification-fixtures
#      regexp: precompiled-bosh-(255.8)-on-ubuntu-3232.3.tgz
#      region_name: us-east-1
#  - name: old-stemcell
#    type: s3
#    source:
#      bucket: bosh-cpi-certification-fixtures
#      regexp: bosh-stemcell-(3232.3)-vsphere-esxi-ubuntu-trusty-go_agent.tgz
#      region_name: us-east-1
#  - name: bosh-cli
#    type: s3
#    source:
#      regexp: bosh-cli-([0-9.]+)-linux-amd64
#      bucket: bosh-cli-artifacts
#      region_name: us-east-1
#  - name: bats
#    type: git
#    source:
#      uri: https://github.com/cloudfoundry/bosh-acceptance-tests.git
#      branch: master
#  - name: tracker-output
#    type: tracker
#    source:
#      token: {{tracker_api_token}}
#      project_id: {{tracker_project_id}}
#      tracker_url: https://www.pivotaltracker.com
#
#groups:
#
#- name: Complete-View
#  jobs:
#  - unit-test
#  - build-candidate
#  - bats
#  - lock-bats
#  - unlock-bats
#  - lock-6.5
#  - lifecycle-6.5
#  - unlock-6.5
#  - lock-6.7
#  - lifecycle-6.7
#  - unlock-6.7
#  - lifecycle-6.0
#  - lock-6.0
#  - unlock-6.0
#  - promote-candidate
#  - lock-6.5-NSXV
#  - lifecycle-6.5-NSXV
#  - unlock-6.5-NSXV
#  - lifecycle-6.0-NSXV
#  - lock-6.0-NSXV
#  - unlock-6.0-NSXV
#  - lifecycle-5.5
#  - lock-5.5
#  - unlock-5.5
#
#
#- name: Delivery
#  jobs:
#  - lifecycle-6.5
#  - lifecycle-6.0
#  - lifecycle-5.5
#  - lifecycle-6.7
#  - lifecycle-6.5-NSXV
#  - lifecycle-6.0-NSXV
#  - bats
#  - delivery
#
#- name: bats
#  jobs:
#  - unit-test
#  - bats
#  - lock-bats
#  - unlock-bats
#
#
#- name: v6.5
#  jobs:
#  - unit-test
#  - lock-6.5
#  - lifecycle-6.5
#  - unlock-6.5
#  - lock-6.5-NSXV
#  - lifecycle-6.5-NSXV
#  - unlock-6.5-NSXV
#
#- name: v6.0
#  jobs:
#  - unit-test
#  - lifecycle-6.0
#  - lock-6.0
#  - unlock-6.0
#  - lifecycle-6.0-NSXV
#  - lock-6.0-NSXV
#  - unlock-6.0-NSXV
#
#- name: v5.5
#  jobs:
#  - unit-test
#  - lifecycle-5.5
#  - lock-5.5
#  - unlock-5.5
#
#- name: v6.7
#  jobs:
#  - unit-test
#  - lifecycle-6.7
#  - lock-6.7
#  - unlock-6.7